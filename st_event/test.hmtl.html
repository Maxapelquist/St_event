<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Auktorisera med Google API</title>
</head>
<body>
    <h1>Auktorisera med Google API</h1>

    <button id="authorize-button" onclick="oauthSignIn()">Auktorisera</button>
    <p id="status">Väntar på auktorisering...</p>

    <script>
        function oauthSignIn() {
            // Google's OAuth 2.0 endpoint for requesting an access token
            var oauth2Endpoint = 'https://accounts.google.com/o/oauth2/v2/auth';

            // Parameters to pass to OAuth 2.0 endpoint.
            var params = {
                'client_id': '545362542799-isl8bej8ofg9de92h93mh0edeujgkvcg.apps.googleusercontent.com', // Byt ut med ditt klient-ID
                'redirect_uri': 'http://localhost:63342/redirect',
                'response_type': 'token',
                'scope': 'https://www.googleapis.com/auth/spreadsheets',
                'include_granted_scopes': 'true',
                'state': 'pass-through value'
            };

            // Construct the authorization URL
            var authUrl = oauth2Endpoint + '?' + Object.keys(params).map(function (key) {
                return key + '=' + encodeURIComponent(params[key]);
            }).join('&');

            // Redirect the user to the authorization URL
            window.location.href = authUrl;
        }
    </script>
</body>
</html>
